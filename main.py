import numpy as np
import matplotlib.pyplot as plt
import finit_module as fmd
from method import method_v

N = 32
Edge = np.pi


def add_noise(z, perc, N):
    ampl = (z.max() - z.min()) * perc
    return z + 2 * ampl * np.random.randn(N, N) - ampl / 2


x = np.linspace(-Edge, Edge, N, endpoint=False)
y = np.linspace(-Edge, Edge, N, endpoint=False)
Y, X = np.meshgrid(x, y)


def multifocal(Rs, Zs):
    n = len(Rs)
    Z = np.zeros((N, N))

    for k in range(n):
        R = Rs[k]
        zz = Zs[k]
        for i in range(N):
            for j in range(N):
                if R * R - X[i][j] ** 2 - Y[i][j] ** 2 > 0:
                    if Z[i][j] < np.sqrt(R * R - X[i][j] ** 2 - Y[i][j] ** 2) + zz:
                        Z[i][j] = np.sqrt(R * R - X[i][j] ** 2 - Y[i][j] ** 2) + zz

    return Z


def multifocal_razr(Rs, Zs, R2s):
    n = len(Rs)
    Z = np.zeros((N, N))

    for k in range(n):
        R = Rs[k]
        zz = Zs[k]
        for i in range(N):
            for j in range(N):
                if R2s[k] ** 2 <= X[i][j] ** 2 + Y[i][j] ** 2 < R2s[k + 1] ** 2:
                    if np.sqrt(R * R - X[i][j] ** 2 - Y[i][j] ** 2) + zz >= 0:
                        Z[i][j] = np.sqrt(R * R - X[i][j] ** 2 - Y[i][j] ** 2) + zz

    return Z


def to_polar_teta(x, y):
    if x > 0 and y >= 0:
        return np.arctan(y / x)
    if x > 0 > y:
        return np.arctan(y / x) + 2 * np.pi
    if x < 0:
        return np.arctan(y / x) + np.pi
    if x == 0 and y > 0:
        return np.pi / 2
    if x == 0 and y < 0:
        return 3 * np.pi / 2
    if x == 0 and y == 0:
        return 0


def to_polar_r(x, y):
    return np.sqrt(x ** 2 + y ** 2)


def spiral(f0, f1, x, y):
    N1 = x.shape[0]
    r = np.zeros((N1, N1))
    teta = np.zeros((N1, N1))
    for i in range(N1):
        for j in range(N1):
            r[i][j] = to_polar_r(x[i][j], y[i][j]) * 0.8
            teta[i][j] = to_polar_teta(x[i][j], y[i][j])

    ff = f1 * (teta - np.pi) / np.pi
    u = r ** 2 / (2 * f0 + 2 * ff)
    return u


def offset(z1, z2, pnt, sprl_flg):
    if sprl_flg != 1:
        v_offset = (np.average(z1[0, :]) + np.average(z1[pnt - 1, :]) +
                    np.average(z1[:, 0]) + np.average(z1[:, pnt - 1])) / 4
    else:
        v_offset = np.min(z1) - np.min(z2)

    return v_offset


def make_zeros(z, pnt=4):
    sz = np.shape(z)[0]
    z[:pnt, :] = 0
    z[sz - pnt:, :] = 0
    z[:, :pnt] = 0
    z[:, sz - pnt:] = 0
    return z


def cut_zeros(z, pnt=4):
    sz = np.shape(z)[0]
    return z[pnt: sz - pnt, pnt: sz - pnt]


def gauss(x, y):
    z = np.sin(x)
    return z


# z = multifocal([1, 3, 12], [0.8, -1.5, -11])
z = multifocal([1, 3], [0.8, -1.5])
# z = multifocal_razr([np.sqrt(3), 3], [0.8, -1.5], [0, 1, 3])
# z = spiral(3, 1, X, Y)
# z = gauss(X, Y)

z = add_noise(z, 0.01, N)

gamma_dict = {'gammas00': 0.5720136773631416, 'gammas01': 0.5082008185999575, 'gammas02': 0.2497390693898996,
              'gammas03': 0.024398045989806612, 'gammas04': 0.44816572215023565, 'gammas05': 0.48552391895708225,
              'gammas06': 0.9291007681835158, 'gammas07': 0.11890145496472776, 'gammas08': 0.3992006941594901,
              'gammas09': 0.08687262790055628, 'gammas010': 0.6076295609947902, 'gammas011': 0.2864367369862437,
              'gammas012': 0.4541962592582557, 'gammas013': 0.4748270043746012, 'gammas014': 0.9224941743167775,
              'gammas015': 0.5974090746617824, 'gammas016': 0.1731660981268674, 'gammas017': 0.9319898223861477,
              'gammas018': 0.8457224920252994, 'gammas019': 0.7367341967113082, 'gammas020': 0.6973373749798467,
              'gammas021': 0.02946871634372525, 'gammas022': 0.9685951957089182, 'gammas023': 0.3585285266862127,
              'gammas024': 0.06466226146330438, 'gammas025': 0.1996883439561022, 'gammas026': 0.7341667315321019,
              'gammas027': 0.6212577995634395, 'gammas028': 0.6615584862043548, 'gammas029': 0.189871332423379,
              'gammas030': 0.06568357167562663, 'gammas031': 0.49132326228974343, 'gammas10': 0.9296417392239116,
              'gammas11': 0.6184218055716422, 'gammas12': 0.29361876632306033, 'gammas13': 0.07203632045596285,
              'gammas14': 0.7290055179887729, 'gammas15': 0.7678361892264596, 'gammas16': 0.26164625668805996,
              'gammas17': 0.14386485927709072, 'gammas18': 0.32408794216096803, 'gammas19': 0.8996341729063491,
              'gammas110': 0.06214819819277857, 'gammas111': 0.8369515723518752, 'gammas112': 0.4494162021640916,
              'gammas113': 0.8675562812946115, 'gammas114': 0.9009619494260712, 'gammas115': 0.9168292945272005,
              'gammas116': 0.38029867566875003, 'gammas117': 0.1434595726831327, 'gammas118': 0.9144828237391012,
              'gammas119': 0.14854573392501363, 'gammas120': 0.7317814549185034, 'gammas121': 0.010366129609669563,
              'gammas122': 0.7213908275067233, 'gammas123': 0.5977002361854962, 'gammas124': 0.4109962814357332,
              'gammas125': 0.1671394730985013, 'gammas126': 0.7073249546777588, 'gammas127': 0.4478727291383069,
              'gammas128': 0.8419343202241849, 'gammas129': 0.9294763521731395, 'gammas130': 0.6555106007530481,
              'gammas131': 0.09782109912629341, 'gammas20': 0.6382551749001463, 'gammas21': 0.8112651206519457,
              'gammas22': 0.8476449051875633, 'gammas23': 0.9185284994034265, 'gammas24': 0.5347285451717942,
              'gammas25': 0.4543504436405529, 'gammas26': 0.15106038122143495, 'gammas27': 0.3537909497013242,
              'gammas28': 0.5161754882826259, 'gammas29': 0.3056337485250775, 'gammas210': 0.39188491181567375,
              'gammas211': 0.45266826653372544, 'gammas212': 0.868267617562064, 'gammas213': 0.95260872212434,
              'gammas214': 0.20816829983318938, 'gammas215': 0.8845284815315101, 'gammas216': 0.21994274989963342,
              'gammas217': 0.5855772697438932, 'gammas218': 0.8525697774773817, 'gammas219': 0.22424375316937975,
              'gammas220': 0.31521594532324426, 'gammas221': 0.14925330615292626, 'gammas222': 0.49503009200472237,
              'gammas223': 0.4977728188366862, 'gammas224': 0.5041212151701147, 'gammas225': 0.8013239132391061,
              'gammas226': 0.7101539139207087, 'gammas227': 0.275164382974174, 'gammas228': 0.7055340273236328,
              'gammas229': 0.026592153620642933, 'gammas230': 0.6376885898429087, 'gammas231': 0.512798902203956,
              'gammas30': 0.8146194458180804, 'gammas31': 0.9987453322144556, 'gammas32': 0.14032257857416625,
              'gammas33': 0.36220217574070945, 'gammas34': 0.8244525997332396, 'gammas35': 0.2674265452482623,
              'gammas36': 0.4010636931087326, 'gammas37': 0.19452409747393418, 'gammas38': 0.7208178299902598,
              'gammas39': 0.893893283860574, 'gammas310': 0.7031230164434956, 'gammas311': 0.13130940458117202,
              'gammas312': 0.22066560404715002, 'gammas313': 0.09628181680498374, 'gammas314': 0.8668803261735228,
              'gammas315': 0.9492348360890093, 'gammas316': 0.6119270820458663, 'gammas317': 0.44363023911314964,
              'gammas318': 0.9690642690209947, 'gammas319': 0.5440046453165355, 'gammas320': 0.26462260911924307,
              'gammas321': 0.22948059675348387, 'gammas322': 0.13353773485083759, 'gammas323': 0.14757249084892715,
              'gammas324': 0.5214460361509689, 'gammas325': 0.20167771952987237, 'gammas326': 0.8271478046534277,
              'gammas327': 0.9386456771479648, 'gammas328': 0.900209352568165, 'gammas329': 0.14043429994739193,
              'gammas330': 0.2185464051458752, 'gammas331': 0.4728519924967278, 'gammas40': 0.9659926568200368,
              'gammas41': 0.4218264119141122, 'gammas42': 0.8548943128988087, 'gammas43': 0.6598769246598654,
              'gammas44': 0.23085707768833713, 'gammas45': 0.4123521455025481, 'gammas46': 0.3295614466947112,
              'gammas47': 0.8056601841758122, 'gammas48': 0.6038822848495544, 'gammas49': 0.8215808767957508,
              'gammas410': 0.006076190404964696, 'gammas411': 0.0707261463119879, 'gammas412': 0.8658613603501787,
              'gammas413': 0.42386182411568013, 'gammas414': 0.752833239624961, 'gammas415': 0.7114475397970428,
              'gammas416': 0.896673484735804, 'gammas417': 0.5975795479449983, 'gammas418': 0.8515214618388348,
              'gammas419': 0.8772210114057162, 'gammas420': 0.8406025699378111, 'gammas421': 0.612763992984629,
              'gammas422': 0.5337106360484052, 'gammas423': 0.8749612293448894, 'gammas424': 0.8436295991399845,
              'gammas425': 0.7667274054918776, 'gammas426': 0.2787442209153245, 'gammas427': 0.3086971848608756,
              'gammas428': 0.5665377888739531, 'gammas429': 0.10293660243191649, 'gammas430': 0.49767763575396157,
              'gammas431': 0.040474640350822946, 'gammas50': 0.8331403352963133, 'gammas51': 0.20036212192059977,
              'gammas52': 0.12457287735966216, 'gammas53': 0.8531919555580163, 'gammas54': 0.7225307226730328,
              'gammas55': 0.592615380374969, 'gammas56': 0.26312982296622067, 'gammas57': 0.35249199702665013,
              'gammas58': 0.5637572257079283, 'gammas59': 0.36303574590768456, 'gammas510': 0.2667056386738774,
              'gammas511': 0.5722189499803273, 'gammas512': 0.4455294287148792, 'gammas513': 0.6026323625704241,
              'gammas514': 0.6073090708310822, 'gammas515': 0.7376708855405607, 'gammas516': 0.02710399614560874,
              'gammas517': 0.25916099733574754, 'gammas518': 0.08454941346011041, 'gammas519': 0.7532317185191206,
              'gammas520': 0.2712989379018057, 'gammas521': 0.17536384221583692, 'gammas522': 0.22327817682646744,
              'gammas523': 0.3909194945165323, 'gammas524': 0.46510658097980123, 'gammas525': 0.7113871277539577,
              'gammas526': 0.8714069035156333, 'gammas527': 0.2477900771763466, 'gammas528': 0.9142704780913308,
              'gammas529': 0.8923050865069923, 'gammas530': 0.4494829675841291, 'gammas531': 0.359164440391729,
              'gammas60': 0.49173430951589975, 'gammas61': 0.5999069578325805, 'gammas62': 0.022035586579906466,
              'gammas63': 0.7942964819205263, 'gammas64': 0.5865508214748321, 'gammas65': 0.4258784671148985,
              'gammas66': 0.8984631064206969, 'gammas67': 0.8322331169144264, 'gammas68': 0.5033756890040122,
              'gammas69': 0.7143648718271745, 'gammas610': 0.6698806601849169, 'gammas611': 0.13638874383763985,
              'gammas612': 0.5547850944222946, 'gammas613': 0.34656626398939744, 'gammas614': 0.059587613993428906,
              'gammas615': 0.031375693680251664, 'gammas616': 0.1741832303334919, 'gammas617': 0.4426571427919622,
              'gammas618': 0.3045592181488142, 'gammas619': 0.568599053974497, 'gammas620': 0.7413648035761506,
              'gammas621': 0.3524829473491667, 'gammas622': 0.5177926604331295, 'gammas623': 0.7467056929042013,
              'gammas624': 0.7038114735397185, 'gammas625': 0.5474765093598788, 'gammas626': 0.868730749678635,
              'gammas627': 0.49747578902677503, 'gammas628': 0.25885961831516513, 'gammas629': 0.7589195899607892,
              'gammas630': 0.7182745372508503, 'gammas631': 0.9393300231089639, 'gammas70': 0.894930568309709,
              'gammas71': 0.9797682751135524, 'gammas72': 0.3864415173041281, 'gammas73': 0.3720751422481655,
              'gammas74': 0.7935189992530559, 'gammas75': 0.5189217119806868, 'gammas76': 0.19133714970466473,
              'gammas77': 0.8573099448710008, 'gammas78': 0.9138400645475365, 'gammas79': 0.8440491361470056,
              'gammas710': 0.005106712823139917, 'gammas711': 0.16161045980962988, 'gammas712': 0.7372409646890651,
              'gammas713': 0.9325922990591792, 'gammas714': 0.2910986216946325, 'gammas715': 0.143706713804724,
              'gammas716': 0.15233997113645853, 'gammas717': 0.0861920118605109, 'gammas718': 0.7472880209037579,
              'gammas719': 0.3893290039857853, 'gammas720': 0.09519708659918481, 'gammas721': 0.6160235393429745,
              'gammas722': 0.4551092521237172, 'gammas723': 0.2998587357655288, 'gammas724': 0.9733042832285714,
              'gammas725': 0.9210533535759404, 'gammas726': 0.8348824937918701, 'gammas727': 0.11261454658067203,
              'gammas728': 0.8564300847835842, 'gammas729': 0.23921584251669623, 'gammas730': 0.6525817479763647,
              'gammas731': 0.2056788132380012, 'gammas80': 0.6238392581828959, 'gammas81': 0.5253846855026972,
              'gammas82': 0.8634886195175532, 'gammas83': 0.797917242204791, 'gammas84': 0.8082966605945118,
              'gammas85': 0.2837636124349065, 'gammas86': 0.07419111888611025, 'gammas87': 0.8975340341457981,
              'gammas88': 0.8734150464520227, 'gammas89': 0.6311397548004332, 'gammas810': 0.672430277195596,
              'gammas811': 0.36486025478092804, 'gammas812': 0.7564926958453727, 'gammas813': 0.9637025671169274,
              'gammas814': 0.476003442591366, 'gammas815': 0.9319441848692431, 'gammas816': 0.5401164399158817,
              'gammas817': 0.8020014318453714, 'gammas818': 0.2625131211091291, 'gammas819': 0.8013920993990709,
              'gammas820': 0.08108516809382506, 'gammas821': 0.7005750414217626, 'gammas822': 0.24356548200750183,
              'gammas823': 0.15086132507382732, 'gammas824': 0.6687976044532826, 'gammas825': 0.7843705127852217,
              'gammas826': 0.2923015732207554, 'gammas827': 0.9641443200042756, 'gammas828': 0.2380483663606519,
              'gammas829': 0.251747309901522, 'gammas830': 0.8318148772561109, 'gammas831': 0.20167268656200024,
              'gammas90': 0.46862924137787304, 'gammas91': 0.0025597007209424635, 'gammas92': 0.7071313216172008,
              'gammas93': 0.08165201763338781, 'gammas94': 0.40174751278943754, 'gammas95': 0.8398022973706775,
              'gammas96': 0.44672974047564884, 'gammas97': 0.08959095771637192, 'gammas98': 0.4636991715509295,
              'gammas99': 0.19325639144974818, 'gammas910': 0.6284587402372294, 'gammas911': 0.9565324391731731,
              'gammas912': 0.5255317643069342, 'gammas913': 0.07952861576183694, 'gammas914': 0.29397674398283086,
              'gammas915': 0.9752466988530492, 'gammas916': 0.048710279897921975, 'gammas917': 0.20499131238915508,
              'gammas918': 0.8949936314813751, 'gammas919': 0.2894007390946829, 'gammas920': 0.18300211509306546,
              'gammas921': 0.689901069511329, 'gammas922': 0.15935720368771336, 'gammas923': 0.894990646318564,
              'gammas924': 0.3916510992704099, 'gammas925': 0.9648439502227897, 'gammas926': 0.14393352606916346,
              'gammas927': 0.7470148490666374, 'gammas928': 0.0011510407844033677, 'gammas929': 0.787610195942178,
              'gammas930': 0.03435612395162624, 'gammas931': 0.5416452827302667, 'gammas100': 0.12254357022565315,
              'gammas101': 0.262456132087994, 'gammas102': 0.7463778224554858, 'gammas103': 0.5372505054996035,
              'gammas104': 0.3075646986897803, 'gammas105': 0.5644477256013949, 'gammas106': 0.9994306573464858,
              'gammas107': 0.8216749423060589, 'gammas108': 0.7638061751047449, 'gammas109': 0.10847385595929196,
              'gammas1010': 0.2806875683707382, 'gammas1011': 0.2733070797351835, 'gammas1012': 0.494052386403554,
              'gammas1013': 0.8944975525709187, 'gammas1014': 0.08541009054911561, 'gammas1015': 0.17802025414051023,
              'gammas1016': 0.11067800299483628, 'gammas1017': 0.1826965748003711, 'gammas1018': 0.12195970145462583,
              'gammas1019': 0.9344733074683659, 'gammas1020': 0.48109214842933734, 'gammas1021': 0.42637750919241396,
              'gammas1022': 0.4389937616004893, 'gammas1023': 0.8228894353064937, 'gammas1024': 0.2711224819407973,
              'gammas1025': 0.8229027740960491, 'gammas1026': 0.13483833470166387, 'gammas1027': 0.019306742235950435,
              'gammas1028': 0.4889755497205198, 'gammas1029': 0.6261057077206672, 'gammas1030': 0.7003672861696655,
              'gammas1031': 0.9670571765021541, 'gammas1110': 0.6602862692621516, 'gammas1111': 0.1226415514879166,
              'gammas1112': 0.6967168886835672, 'gammas1113': 0.12475498581005254, 'gammas1114': 0.45099635808041155,
              'gammas1115': 0.7683149692897548, 'gammas1116': 0.8665139441917744, 'gammas1117': 0.840834722744459,
              'gammas1118': 0.47174780234833413, 'gammas1119': 0.5279568584341051, 'gammas1120': 0.44418481485283384,
              'gammas1121': 0.4174369286955836, 'gammas1122': 0.4654170812916614, 'gammas1123': 0.705381503024141,
              'gammas1124': 0.4739064581887163, 'gammas1125': 0.48461556031682745, 'gammas1126': 0.2198960886292668,
              'gammas1127': 0.5076803194649384, 'gammas1128': 0.26718828554759155, 'gammas1129': 0.9415389707638874,
              'gammas1130': 0.1536738335050016, 'gammas1131': 0.022994757725443862, 'gammas1210': 0.18412532325197184,
              'gammas1211': 0.9288012495281934, 'gammas1212': 0.931781929891696, 'gammas1213': 0.236151749460904,
              'gammas1214': 0.7793860146821824, 'gammas1215': 0.936508564836338, 'gammas1216': 0.5502988701432882,
              'gammas1217': 0.14761521302902486, 'gammas1218': 0.24458014707608225, 'gammas1219': 0.6953402856787152,
              'gammas1220': 0.09371282168550225, 'gammas1221': 0.07057288374375305, 'gammas1222': 0.22957869163886546,
              'gammas1223': 0.7594406331735029, 'gammas1224': 0.3770105928169845, 'gammas1225': 0.7680741538902172,
              'gammas1226': 0.25578859081449945, 'gammas1227': 0.9346116739874948, 'gammas1228': 0.9152419549091254,
              'gammas1229': 0.8264264877954056, 'gammas1230': 0.49023666256732235, 'gammas1231': 0.8335461719553736,
              'gammas132': 0.12297772469223534, 'gammas133': 0.1807847853888973, 'gammas134': 0.8983154766554408,
              'gammas135': 0.5463785375584622, 'gammas136': 0.2679445297987159, 'gammas137': 0.23838509516080603,
              'gammas138': 0.6480363744232795, 'gammas139': 0.21816939337993263, 'gammas1310': 0.60994497621425,
              'gammas1311': 0.5071421507714426, 'gammas1312': 0.2603567478644064, 'gammas1313': 0.13014795020701073,
              'gammas1314': 0.6185233214448738, 'gammas1315': 0.8148729312104861, 'gammas1316': 0.024245353685855443,
              'gammas1317': 0.6025215402775428, 'gammas1318': 0.9368975831945743, 'gammas1319': 0.18606688154059606,
              'gammas1320': 0.4296808045409492, 'gammas1321': 0.2969538945735623, 'gammas1322': 0.7153007239088586,
              'gammas1323': 0.45375999214488666, 'gammas1324': 0.0660478075419525, 'gammas1325': 0.4543455388740919,
              'gammas1326': 0.8244690786253006, 'gammas1327': 0.6256504554831478, 'gammas1328': 0.7904571923497999,
              'gammas1329': 0.300746567807637, 'gammas1330': 0.2129691612601243, 'gammas1331': 0.6192164125259625,
              'gammas140': 0.47330202817624845, 'gammas141': 0.8077510837184799, 'gammas142': 0.20946802701541037,
              'gammas143': 0.03745651611700067, 'gammas144': 0.06775653808559896, 'gammas145': 0.16498331454226633,
              'gammas146': 0.6552993166704331, 'gammas147': 0.2982622346893657, 'gammas148': 0.34147366786749533,
              'gammas149': 0.910412470289478, 'gammas1410': 0.46484739590501806, 'gammas1411': 0.41860356334497056,
              'gammas1412': 0.7164233501357887, 'gammas1413': 0.4844140972997518, 'gammas1414': 0.6211310224470634,
              'gammas1415': 0.22464805984440922, 'gammas1416': 0.150284134931189, 'gammas1417': 0.068951661374761,
              'gammas1418': 0.5559413907722947, 'gammas1419': 0.7856105563489684, 'gammas1420': 0.11809717566821665,
              'gammas1421': 0.5408040440587866, 'gammas1422': 0.8156686216300943, 'gammas1423': 0.05427038591334843,
              'gammas1424': 0.8545833400171241, 'gammas1425': 0.9208746214627714, 'gammas1426': 0.6505687617315772,
              'gammas1427': 0.5295902507838924, 'gammas1428': 0.1456393706209139, 'gammas1429': 0.14933097095893674,
              'gammas1430': 0.9046365245917699, 'gammas1431': 0.18172574448791873, 'gammas150': 0.6071775757604161,
              'gammas151': 0.78772753838106, 'gammas152': 0.6669946005867936, 'gammas153': 0.09011900022163388,
              'gammas154': 0.6303301668224233, 'gammas155': 0.34043552518298, 'gammas156': 0.2685787356189444,
              'gammas157': 0.7844361599305102, 'gammas158': 0.2627800490976809, 'gammas159': 0.43809148182001023,
              'gammas1510': 0.06770217011052326, 'gammas1511': 0.16767508052644958, 'gammas1512': 0.935162125261815,
              'gammas1513': 0.6419401780193218, 'gammas1514': 0.31531141523659517, 'gammas1515': 0.2520319284233719,
              'gammas1516': 0.055734410562944287, 'gammas1517': 0.6616403251633454, 'gammas1518': 0.5299500085810378,
              'gammas1519': 0.1536097671414185, 'gammas1520': 0.3545923495728175, 'gammas1521': 0.8140816921650884,
              'gammas1522': 0.41326007959167455, 'gammas1523': 0.2435656404829143, 'gammas1524': 0.7835822561249279,
              'gammas1525': 0.496629501056746, 'gammas1526': 0.3406993882795133, 'gammas1527': 0.8478505949615734,
              'gammas1528': 0.674427556882772, 'gammas1529': 0.5885363850873118, 'gammas1530': 0.7611530439160272,
              'gammas1531': 0.44779779347168047, 'gammas160': 0.4947074528334644, 'gammas161': 0.9727436811279013,
              'gammas162': 0.9797187642364076, 'gammas163': 0.581767138942906, 'gammas164': 0.3822608335723606,
              'gammas165': 0.9506238936754656, 'gammas166': 0.7139026992515042, 'gammas167': 0.8696884167883061,
              'gammas168': 0.4892399500481357, 'gammas169': 0.16843171322265318, 'gammas1610': 0.26199866382039816,
              'gammas1611': 0.9614007057458733, 'gammas1612': 0.0014066528188522165, 'gammas1613': 0.5447398149101739,
              'gammas1614': 0.25500891325151254, 'gammas1615': 0.8054995429574386, 'gammas1616': 0.6956000817349536,
              'gammas1617': 0.06178707990949815, 'gammas1618': 0.7451742805852699, 'gammas1619': 0.16556897679433846,
              'gammas1620': 0.17367327388150272, 'gammas1621': 0.5064713319291168, 'gammas1622': 0.9509140524239897,
              'gammas1623': 0.6103736779440807, 'gammas1624': 0.3479101580527358, 'gammas1625': 0.726216281020668,
              'gammas1626': 0.22954409614991278, 'gammas1627': 0.47748962297355707, 'gammas1628': 0.8569881209023882,
              'gammas1629': 0.3214471221778553, 'gammas1630': 0.2983564649061662, 'gammas1631': 0.4288877027208671,
              'gammas170': 0.4847948754353373, 'gammas171': 0.9223308255230768, 'gammas172': 0.917529573170484,
              'gammas173': 0.15640625786589815, 'gammas174': 0.45327172969756785, 'gammas175': 0.3228926439812564,
              'gammas176': 0.8552046823757813, 'gammas177': 0.6120855282314479, 'gammas178': 0.2827354988289759,
              'gammas179': 0.6148359888131598, 'gammas1710': 0.009329364939104356, 'gammas1711': 0.3393982252463199,
              'gammas1712': 0.08580000927767563, 'gammas1713': 0.9869082460002496, 'gammas1714': 0.22947852001243757,
              'gammas1715': 0.24377992958549566, 'gammas1716': 0.16259854562355686, 'gammas1717': 0.8127254736373312,
              'gammas1718': 0.13518943780942957, 'gammas1719': 0.29765312479924355, 'gammas1720': 0.2174049929273596,
              'gammas1721': 0.03467773054739434, 'gammas1722': 0.24259603544240288, 'gammas1723': 0.004127182984441188,
              'gammas1724': 0.5212124773457194, 'gammas1725': 0.20909136839981285, 'gammas1726': 0.40226302871331704,
              'gammas1727': 0.4103069755731561, 'gammas1728': 0.08485932548647304, 'gammas1729': 0.8849205039780887,
              'gammas1730': 0.0027716360873611956, 'gammas1731': 0.8698499123365407, 'gammas180': 0.5382799345098961,
              'gammas181': 0.9127081437226627, 'gammas182': 0.8028365851197283, 'gammas183': 0.13785429928798124,
              'gammas184': 0.5165880728176836, 'gammas185': 0.2340762368191734, 'gammas186': 0.32223879802608607,
              'gammas187': 0.2941195440888237, 'gammas188': 0.736821083562628, 'gammas189': 0.6663354362657361,
              'gammas1810': 0.8326809613908963, 'gammas1811': 0.6408453163767246, 'gammas1812': 0.6759913243025415,
              'gammas1813': 0.8442778882169885, 'gammas1814': 0.5445549348081512, 'gammas1815': 0.4113112771584383,
              'gammas1816': 0.07980603129447095, 'gammas1817': 0.36206011605245764, 'gammas1818': 0.5727492996765432,
              'gammas1819': 0.8613809569018654, 'gammas1820': 0.13982558621802765, 'gammas1821': 0.2541718042255587,
              'gammas1822': 0.36902664535474783, 'gammas1823': 0.14120280371434035, 'gammas1824': 0.47390158391531007,
              'gammas1825': 0.6713595741612189, 'gammas1826': 0.10599626072454096, 'gammas1827': 0.5824113312549034,
              'gammas1828': 0.7365907069465764, 'gammas1829': 0.9273140303878661, 'gammas1830': 0.746291614821688,
              'gammas1831': 0.7027816267366976, 'gammas190': 0.22915549160639867, 'gammas191': 0.6965634439039307,
              'gammas192': 0.8704844575094378, 'gammas193': 0.6781807754894956, 'gammas194': 0.6495505114210164,
              'gammas195': 0.5160699158536706, 'gammas196': 0.7822465417625767, 'gammas197': 0.15437672438278086,
              'gammas198': 0.7100274992027671, 'gammas199': 0.6282267441997951, 'gammas1910': 0.6237525992209848,
              'gammas1911': 0.40279049003247824, 'gammas1912': 0.1571234638087038, 'gammas1913': 0.6518051239678184,
              'gammas1914': 0.9982935791270301, 'gammas1915': 0.17280405089887002, 'gammas1916': 0.5604949184804751,
              'gammas1917': 0.7927700050518586, 'gammas1918': 0.7601593763528519, 'gammas1919': 0.5317598190247887,
              'gammas1920': 0.07498572291884993, 'gammas1921': 0.12768341974041475, 'gammas1922': 0.7864914622325017,
              'gammas1923': 0.7750257523554822, 'gammas1924': 0.35059145880112086, 'gammas1925': 0.20268883966550444,
              'gammas1926': 0.5855469561937399, 'gammas1927': 0.8119352081354365, 'gammas1928': 0.7760505849630789,
              'gammas1929': 0.24776462547697986, 'gammas1930': 0.4825052486618639, 'gammas1931': 0.7780551381154677,
              'gammas200': 0.2638796169653821, 'gammas201': 0.5555302374289406, 'gammas202': 0.23156569874734317,
              'gammas203': 0.9990987299638612, 'gammas204': 0.4465409001121816, 'gammas205': 0.5896962565625024,
              'gammas206': 0.5394589499691022, 'gammas207': 0.6975709711276866, 'gammas208': 0.07827760141625939,
              'gammas209': 0.328061852742753, 'gammas2010': 0.22786000084201302, 'gammas2011': 0.4409867317710047,
              'gammas2012': 0.3533569441667139, 'gammas2013': 0.21768624726652322, 'gammas2014': 0.30642860453349907,
              'gammas2015': 0.3484486004040083, 'gammas2016': 0.08703519201694132, 'gammas2017': 0.9697091619265199,
              'gammas2018': 0.14415659201044229, 'gammas2019': 0.503155345999919, 'gammas2020': 0.3375087529289481,
              'gammas2021': 0.5346853121270247, 'gammas2022': 0.48754093568591433, 'gammas2023': 0.42958216628334644,
              'gammas2024': 0.23744224808707998, 'gammas2025': 0.18310745624728453, 'gammas2026': 0.4416846260296897,
              'gammas2027': 0.18095176363604704, 'gammas2028': 0.09943890746424046, 'gammas2029': 0.2883068099351771,
              'gammas2030': 0.8308592971070997, 'gammas2031': 0.9317116664867237, 'gammas2110': 0.46270197498616905,
              'gammas2111': 0.4265004529498925, 'gammas2112': 0.6196087069599306, 'gammas2113': 0.1677020639059619,
              'gammas2114': 0.5536387269741848, 'gammas2115': 0.43482284885733746, 'gammas2116': 0.6213182134558377,
              'gammas2117': 0.21137654251837823, 'gammas2118': 0.3209922578773084, 'gammas2119': 0.8263752231390867,
              'gammas2120': 0.39183331787490355, 'gammas2121': 0.07379658820837025, 'gammas2122': 0.7779880305956083,
              'gammas2123': 0.7777013737470695, 'gammas2124': 0.4386047279398861, 'gammas2125': 0.7601540101774409,
              'gammas2126': 0.8544454367669707, 'gammas2127': 0.2726563307320441, 'gammas2128': 0.9031533587284445,
              'gammas2129': 0.25562905546200815, 'gammas2130': 0.9162562975646601, 'gammas2131': 0.7465980842009525,
              'gammas2210': 0.03354427473108327, 'gammas2211': 0.392582701453157, 'gammas2212': 0.5909069584266524,
              'gammas2213': 0.8736047917323924, 'gammas2214': 0.6350243499839322, 'gammas2215': 0.5330099406623767,
              'gammas2216': 0.8169817939153304, 'gammas2217': 0.8489594058497928, 'gammas2218': 0.7851674616450393,
              'gammas2219': 0.17908379114561143, 'gammas2220': 0.46076220226154785, 'gammas2221': 0.38740661483633987,
              'gammas2222': 0.5130507212432053, 'gammas2223': 0.3481629978278999, 'gammas2224': 0.4176300915346258,
              'gammas2225': 0.6741581814466783, 'gammas2226': 0.9476621505503048, 'gammas2227': 0.5203286547502631,
              'gammas2228': 0.732926920905617, 'gammas2229': 0.8469413997102837, 'gammas2230': 0.7314658394419775,
              'gammas2231': 0.7773771709246984, 'gammas232': 0.5343632431222296, 'gammas233': 0.7485336005071163,
              'gammas234': 0.24125996576053993, 'gammas235': 0.10072124126416693, 'gammas236': 0.2575320044013233,
              'gammas237': 0.44279586257993836, 'gammas238': 0.23762118948984584, 'gammas239': 0.2919132634458469,
              'gammas2310': 0.6349356919913604, 'gammas2311': 0.2022592739051838, 'gammas2312': 0.774585972971312,
              'gammas2313': 0.22666420805536347, 'gammas2314': 0.8680337028718461, 'gammas2315': 0.4227545436210739,
              'gammas2316': 0.6379590540243888, 'gammas2317': 0.9987572939813073, 'gammas2318': 0.3387177320922019,
              'gammas2319': 0.9299874795873262, 'gammas2320': 0.13512381788688813, 'gammas2321': 0.7578964768968706,
              'gammas2322': 0.7766292995780232, 'gammas2323': 0.9352601553798423, 'gammas2324': 0.3478773180544537,
              'gammas2325': 0.46011888778580623, 'gammas2326': 0.11315386286179041, 'gammas2327': 0.2016318740842769,
              'gammas2328': 0.6331896352805595, 'gammas2329': 0.18868963988232546, 'gammas2330': 0.8166057880205607,
              'gammas2331': 0.4494362509884068, 'gammas240': 0.8608126000163306, 'gammas241': 0.0943373777276249,
              'gammas242': 0.2406104617027354, 'gammas243': 0.4669886221518784, 'gammas244': 0.8184362084809205,
              'gammas245': 0.17591078079539751, 'gammas246': 0.5272860731090899, 'gammas247': 0.6669869203120704,
              'gammas248': 0.16976075244166094, 'gammas249': 0.03741305423621781, 'gammas2410': 0.9323520242435774,
              'gammas2411': 0.5406475362572863, 'gammas2412': 0.44109582661904206, 'gammas2413': 0.14571879028730073,
              'gammas2414': 0.9558522968881871, 'gammas2415': 0.7881703553095796, 'gammas2416': 0.44487941016603305,
              'gammas2417': 0.10763314725620066, 'gammas2418': 0.3209989502627725, 'gammas2419': 0.05738612292998999,
              'gammas2420': 0.7513398706263008, 'gammas2421': 0.13773090058246495, 'gammas2422': 0.6731193262385301,
              'gammas2423': 0.8543676260828592, 'gammas2424': 0.04132230132053075, 'gammas2425': 0.4129672051356165,
              'gammas2426': 0.8720849203718437, 'gammas2427': 0.7567462042924946, 'gammas2428': 0.8248687094380117,
              'gammas2429': 0.07622962506704792, 'gammas2430': 0.4047929086440877, 'gammas2431': 0.6478618784896787,
              'gammas250': 0.48516971645644213, 'gammas251': 0.6222601751157927, 'gammas252': 0.7390163453370938,
              'gammas253': 0.6958498092929325, 'gammas254': 0.5924425594551014, 'gammas255': 0.8926645764622034,
              'gammas256': 0.016961183800542914, 'gammas257': 0.23873563709495296, 'gammas258': 0.5487720064188631,
              'gammas259': 0.5226501134143957, 'gammas2510': 0.3078132010375818, 'gammas2511': 0.10279897489174065,
              'gammas2512': 0.6566734325366153, 'gammas2513': 0.7810358831309937, 'gammas2514': 0.8638722600810494,
              'gammas2515': 0.3255341429489237, 'gammas2516': 0.6294705633333499, 'gammas2517': 0.3842272922288887,
              'gammas2518': 0.3200549522849711, 'gammas2519': 0.20573013335585572, 'gammas2520': 0.6864705212066342,
              'gammas2521': 0.26050720174881564, 'gammas2522': 0.857601172185866, 'gammas2523': 0.9213697255188977,
              'gammas2524': 0.5237461670018667, 'gammas2525': 0.38651293974216466, 'gammas2526': 0.60083567985717,
              'gammas2527': 0.4674387121119822, 'gammas2528': 0.31621343941581154, 'gammas2529': 0.8565480343571911,
              'gammas2530': 0.4675604965299509, 'gammas2531': 0.2791441493328338, 'gammas260': 0.23193141919739946,
              'gammas261': 0.19348632173465938, 'gammas262': 0.17838510616943531, 'gammas263': 0.17888958700118282,
              'gammas264': 0.8930110332735539, 'gammas265': 0.3046645344608503, 'gammas266': 0.5555692248054005,
              'gammas267': 0.28309382385365056, 'gammas268': 0.9683387039023766, 'gammas269': 0.31968695979166273,
              'gammas2610': 0.08493853435122126, 'gammas2611': 0.7080278087722539, 'gammas2612': 0.1975010426203861,
              'gammas2613': 0.9157420914020522, 'gammas2614': 0.15359245513630193, 'gammas2615': 0.27698318531320404,
              'gammas2616': 0.03275234534795929, 'gammas2617': 0.1671470233412695, 'gammas2618': 0.02420863457827109,
              'gammas2619': 0.9894112571264689, 'gammas2620': 0.6978522612797603, 'gammas2621': 0.6764887051124888,
              'gammas2622': 0.12773213633072683, 'gammas2623': 0.6966812690109465, 'gammas2624': 0.8791021534045549,
              'gammas2625': 0.9752080989094154, 'gammas2626': 0.7781497177037611, 'gammas2627': 0.6122242691264039,
              'gammas2628': 0.5252176987937022, 'gammas2629': 0.5250179044325042, 'gammas2630': 0.3116597067854784,
              'gammas2631': 1.332787459842064e-06, 'gammas270': 0.3098879842674813, 'gammas271': 0.8005229348315768,
              'gammas272': 0.4298858215474597, 'gammas273': 0.5390450192421098, 'gammas274': 0.9132946478257813,
              'gammas275': 0.6580681515910677, 'gammas276': 0.5241327259551154, 'gammas277': 0.6359453512599957,
              'gammas278': 0.36447540386422317, 'gammas279': 0.9457698951354621, 'gammas2710': 0.6625873460474365,
              'gammas2711': 0.7312177686567879, 'gammas2712': 0.10798407522867784, 'gammas2713': 0.8409016965295423,
              'gammas2714': 0.42453686809874375, 'gammas2715': 0.541694685847935, 'gammas2716': 0.9572290517808789,
              'gammas2717': 0.7561122894817389, 'gammas2718': 0.02083537456353153, 'gammas2719': 0.7384575582512675,
              'gammas2720': 0.7002816303009728, 'gammas2721': 0.9277814709770625, 'gammas2722': 0.6558278800918655,
              'gammas2723': 0.4947490651085383, 'gammas2724': 0.15148042085338853, 'gammas2725': 0.5206589889607874,
              'gammas2726': 0.8490619641234413, 'gammas2727': 0.9563170429255631, 'gammas2728': 0.7372714040214877,
              'gammas2729': 0.38642638271799923, 'gammas2730': 0.13699437977971257, 'gammas2731': 0.050690496958778634,
              'gammas280': 0.1870870840190626, 'gammas281': 0.7933561812707777, 'gammas282': 0.7357744911027108,
              'gammas283': 0.30110904779467756, 'gammas284': 0.4796673580753824, 'gammas285': 0.7638300817894756,
              'gammas286': 0.421295433019809, 'gammas287': 0.3258922135871124, 'gammas288': 0.8827269494236316,
              'gammas289': 0.14340426334731277, 'gammas2810': 0.4338801167244421, 'gammas2811': 0.720419224892156,
              'gammas2812': 0.15372222312256842, 'gammas2813': 0.37532394406153796, 'gammas2814': 0.6499582828003625,
              'gammas2815': 0.20478700144468087, 'gammas2816': 0.8115465730505085, 'gammas2817': 0.2607904030000414,
              'gammas2818': 0.1459070281428124, 'gammas2819': 0.9643908465919429, 'gammas2820': 0.828014450251217,
              'gammas2821': 0.7696409369089856, 'gammas2822': 0.7875366289339103, 'gammas2823': 0.12579486037595156,
              'gammas2824': 0.15809773030275273, 'gammas2825': 0.474275890294843, 'gammas2826': 0.14983049013019104,
              'gammas2827': 0.9364434689088494, 'gammas2828': 0.2825785426654214, 'gammas2829': 0.14320284450384912,
              'gammas2830': 0.9018717925237597, 'gammas2831': 0.5683249992731867, 'gammas290': 0.7396870367039561,
              'gammas291': 0.8205289830101558, 'gammas292': 0.9055291803534413, 'gammas293': 0.7603171785689733,
              'gammas294': 0.32300404848760533, 'gammas295': 0.10239623712721674, 'gammas296': 0.34763638507764977,
              'gammas297': 0.11465575579790127, 'gammas298': 0.19810662144781435, 'gammas299': 0.28090839444888643,
              'gammas2910': 0.5624127411578892, 'gammas2911': 0.8505543990058725, 'gammas2912': 0.2539952670469299,
              'gammas2913': 0.2505650261085532, 'gammas2914': 0.0696693958513223, 'gammas2915': 0.408258038500354,
              'gammas2916': 0.26876184306660844, 'gammas2917': 0.18224842300216007, 'gammas2918': 0.4553022345339852,
              'gammas2919': 0.505139774950914, 'gammas2920': 0.14814397484642233, 'gammas2921': 0.6122740801498209,
              'gammas2922': 0.7109345524086829, 'gammas2923': 0.6730397154300745, 'gammas2924': 0.3995481455134408,
              'gammas2925': 0.47470914516170737, 'gammas2926': 0.42976609781366687, 'gammas2927': 0.17138067699606796,
              'gammas2928': 0.8418160634535764, 'gammas2929': 0.3986260303824639, 'gammas2930': 0.0728742499872603,
              'gammas2931': 0.6026330156851536, 'gammas300': 0.7575991909929237, 'gammas301': 0.08334612238711098,
              'gammas302': 0.8207292951636438, 'gammas303': 0.3837110555707775, 'gammas304': 0.4978881342696444,
              'gammas305': 0.1741647683815495, 'gammas306': 0.9036296353133638, 'gammas307': 0.7053701974562476,
              'gammas308': 0.10948776162787333, 'gammas309': 0.9944181119908634, 'gammas3010': 0.4544935327060751,
              'gammas3011': 0.8666947437107031, 'gammas3012': 0.18573290651909902, 'gammas3013': 0.850166287062257,
              'gammas3014': 0.605580897808334, 'gammas3015': 0.31111973181971975, 'gammas3016': 0.14143962807158614,
              'gammas3017': 0.20544450100480055, 'gammas3018': 0.5653716598273659, 'gammas3019': 0.43807352936609306,
              'gammas3020': 0.31322034092210793, 'gammas3021': 0.35128915930475146, 'gammas3022': 0.4401983071155868,
              'gammas3023': 0.7796805280784368, 'gammas3024': 0.2462201677579116, 'gammas3025': 0.8079936029596892,
              'gammas3026': 0.2885178711258899, 'gammas3027': 0.5254960915461779, 'gammas3028': 0.18958516846068785,
              'gammas3029': 0.06769190544804726, 'gammas3030': 0.7624666421024998, 'gammas3031': 0.40860659802755195,
              'gammas3110': 0.6606675377161522, 'gammas3111': 0.8420203393208741, 'gammas3112': 0.5399459853910181,
              'gammas3113': 0.7125012764489125, 'gammas3114': 0.4800337485813797, 'gammas3115': 0.6120682280442672,
              'gammas3116': 0.5610925083418258, 'gammas3117': 0.26889929646756444, 'gammas3118': 0.22945720217453924,
              'gammas3119': 0.08765807346170806, 'gammas3120': 0.8284410904201557, 'gammas3121': 0.5582112155824895,
              'gammas3122': 0.1787323686804781, 'gammas3123': 0.43335676706763027, 'gammas3124': 0.36214082175446827,
              'gammas3125': 0.17033944728383987, 'gammas3126': 0.026880032433759478, 'gammas3127': 0.5671752727423763,
              'gammas3128': 0.5265879348680711, 'gammas3129': 0.04245547462132347, 'gammas3130': 0.7023108237998748,
              'gammas3131': 0.8510309080363085}

gammas = np.zeros((N, N))
for i in range(N):
    for j in range(N):
        gammas[i][j] = gamma_dict[f"gammas{i}{j}"]

print(gammas)

z_approx = method_v(z, N, np.pi, 1, gamma=gammas)

spiral_flag = 0

offs = offset(z_approx, z, N, spiral_flag)


def prepare_for_visual(X1, Y1, Z1):
    if spiral_flag != 1:
        return Z1
    Z2 = Z1
    sz = np.shape(Z1)[0]
    for i in range(np.shape(X1)[0]):
        for j in range(np.shape(Y1)[0]):
            if X1[i][j] > 0 and j == sz // 2:
                Z2[i][j] = np.nan

    return Z2


fig = plt.figure()
ax = fig.add_subplot(121, projection='3d')
surf1 = ax.plot_surface(X, Y, prepare_for_visual(X, Y, z), cmap='plasma')
ax.set_title('Original function')
# ax.set_zlim([0, np.max(fm)])
ax.view_init(45, 60)
# fig.colorbar(surf1, location='bottom', shrink=0.6, aspect=7)

ax = fig.add_subplot(122, projection='3d')
surf2 = ax.plot_surface(X, Y, prepare_for_visual(X, Y, z_approx - offs), cmap='plasma')
ax.set_title('Method approximation')
# ax.set_zlim([0, np.max((z_approx - offs))])
ax.view_init(45, 60)
# fig.colorbar(surf2, location='bottom', shrink=0.6, aspect=7)
plt.show()
